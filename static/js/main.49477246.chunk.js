(this["webpackJsonpmap-my-shifter"]=this["webpackJsonpmap-my-shifter"]||[]).push([[0],{10:function(e,t,a){e.exports={object__item_box:"to_stix_object__item_box__3rr3c",object__item_content:"to_stix_object__item_content__1bWt0",object_item__btn:"to_stix_object_item__btn__mEa_v",object_item__title:"to_stix_object_item__title__2EOEa",object_item__map:"to_stix_object_item__map__11qL1",object_item__field:"to_stix_object_item__field__c6qbN",object_item_field__header:"to_stix_object_item_field__header__3uGd8",statistics__col:"to_stix_statistics__col__3B4_C",title:"to_stix_title__1j-_I",coverage_percent:"to_stix_coverage_percent__1MuDs",coverage_count:"to_stix_coverage_count__2mmRu"}},17:function(e,t,a){e.exports={full_height__col:"from_stix_full_height__col__1eQ-_",mappings_clear__btn:"from_stix_mappings_clear__btn__2uZYz",mapping__col:"from_stix_mapping__col__2hj1M",mapping__item:"from_stix_mapping__item__2zbU-",mapping__item_empty:"from_stix_mapping__item_empty__2ASue",mapping_item__title:"from_stix_mapping_item__title__3lf6b",mapping_item__btn:"from_stix_mapping_item__btn__2F3K3",mapping_item__btn_top:"from_stix_mapping_item__btn_top__1uHP6",export__col:"from_stix_export__col__eJkaX",import__col:"from_stix_import__col__-Iooq",statistics__col:"from_stix_statistics__col__3p8y7",title:"from_stix_title__1OqJJ",coverage_percent:"from_stix_coverage_percent__1w-W7",coverage_count:"from_stix_coverage_count__sw3gc"}},29:function(e,t,a){e.exports={full_height__col:"stix_full_height__col__1AWJO",add_fields__col:"stix_add_fields__col__2Vl3O",field__title:"stix_field__title__23yrc",field__item:"stix_field__item__3Zx1b",colored:"stix_colored__3Ifb3",hover:"stix_hover__YWNMC"}},52:function(e,t,a){e.exports={tile__btn:"welcome_tile__btn__1S4p7"}},56:function(e,t,a){e.exports=a.p+"static/media/logo-no-bg.a33c514a.png"},58:function(e,t,a){e.exports={export__col:"export_export__col__2dFQV"}},59:function(e,t,a){e.exports={import__col:"import_import__col__3Dz6_"}},66:function(e,t,a){e.exports=a(79)},71:function(e,t,a){},75:function(e,t,a){},78:function(e,t,a){},79:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(42),c=a.n(r),l=(a(71),a(28)),o=a(12),m=a(6),s=a(103),d=(a(75),"stix_version_2_0"),u="stix_version_2_1";function p(e){return{type:"CHANGE_STIX_VERSION",payload:{version:e}}}var _=a(86),b=a(87),f=a(88),E=a(89),v=a(90),j=function(){var e=Object(m.b)();return i.a.createElement(_.a,{"aria-label":"Carbon Tutorial"},i.a.createElement(b.a,null),i.a.createElement(f.a,{element:l.b,to:"/",prefix:"MAP"},"My Shifter"),i.a.createElement(E.a,{"aria-label":"Side navigation"},i.a.createElement(v.a,{element:l.b,to:"/from_stix",onClick:function(){return e(p(d))}},"From STIX"),i.a.createElement(v.a,{element:l.b,to:"/to_stix",onClick:function(){return e(p(d))}},"To STIX"),i.a.createElement(v.a,{element:l.b,to:"/about"},"About")))},O=a(56),y=a.n(O),g=a(91),x=a(52),h=a.n(x),N=function(){var e=Object(m.b)(),t=Object(o.f)(),a=function(a){e(p(d)),t.push(a)};return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"bx--grid"},i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col"},i.a.createElement("img",{src:y.a,alt:"Logo",width:300}))),i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col"},i.a.createElement("p",null,"This tool is used for generating mapping file for `STIX-Shifter` project"))),i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col-sm-2"},i.a.createElement(g.a,{handleClick:function(){return a("/from_stix")},className:h.a.tile__btn},'Generate "From STIX" File')),i.a.createElement("div",{className:"bx--col-sm-2"},i.a.createElement(g.a,{handleClick:function(){return a("/to_stix")},className:h.a.tile__btn},'Generate "To STIX" File')))))},S=a(15),I=a(9),q=a(23);function T(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:"ADD_FIELD",payload:{field:e,required:t}}}function F(e){return{type:"UPDATE_FROM_STIX_MAPPINGS_FROM_FILE",payload:{mappings:e}}}function w(){return{type:"CLEAR_FROM_STIX_MAPPINGS"}}var C=a(107),D=a(106),A=function(e){return/(^\S+:+\S+$)/.test(e)},L=function(){var e=Object(m.c)((function(e){return e.fromStix.customFieldModalShow})),t=Object(m.b)(),a=Object(n.useState)(""),r=Object(S.a)(a,2),c=r[0],l=r[1];return i.a.createElement(C.a,{open:e,size:"xs",modalHeading:"Add custom field",primaryButtonText:"Add",secondaryButtonText:"Cancel",onRequestClose:function(){l(""),t({type:"CLOSE_CUSTOM_FIELD_MODAL"})},onRequestSubmit:function(){var e=c.split(":"),a=Object(S.a)(e,2),n=a[0],i=a[1];t(T(n,i)),l(""),t({type:"CLOSE_CUSTOM_FIELD_MODAL"})},primaryButtonDisabled:!A(c),shouldSubmitOnEnter:!0,hasForm:!0},i.a.createElement(D.a,{id:"customField",type:"text",labelText:'e.g "x-oca-event:category_id"',onChange:function(e){l(e.target.value)},invalid:""!==c&&!A(c),invalidText:"A valid value is required"}))},M=a(93),k=function(){var e=Object(m.b)(),t=Object(m.c)((function(e){return e.fromStix.customFieldModalShow}));return i.a.createElement("div",null,i.a.createElement(M.a,{kind:"tertiary",size:"sm",onClick:function(){e({type:"SHOW_CUSTOM_FIELD_MODAL"})}},"Custom Field"),t&&i.a.createElement(L,null))},P=a(80),R=a(29),X=a.n(R),U=a(94);function B(e,t,a,n,i){return{type:"UPDATE_STIX_FIELD",payload:{objectName:e,fieldId:t,mappingId:a,value:n,type:i}}}function V(){return{type:"CLEAR_TO_STIX_MAPPINGS"}}function K(e){return{type:"UPDATE_TO_STIX_MAPPINGS_FROM_FILE",payload:{mappings:e}}}var H=function(e){var t=e.title,a=e.type,n=e.items,r=e.objectName,c=e.fieldId,l=e.stixFieldId,o=e.updateType,s=e.objects,d=Object(m.b)();return i.a.createElement(U.a,{title:s?"".concat(t,"  (").concat(s[a].size,"/").concat(n.length,")"):"".concat(t)},i.a.createElement("ul",null,n.map((function(e){return i.a.createElement("li",{key:e.name,onClick:function(){!function(e,t,n,i,r,c){n&&i&&r&&c?(d(B(n,i,r,e,c)),d({type:"CLOSE_SELECT_FIELD_MODAL"})):s[a].has(e.split(":")[1])||d(T(e,t))}("".concat(a,":").concat(e.name),e.required,r,c,l,o)},className:s&&s[a].has("".concat(e.name))?"".concat(X.a.field__item," ").concat(X.a.colored):"".concat(X.a.field__item," ").concat(X.a.hover)},e.name," ",e.required?"(*)":"")}))))},J=a(109),W=function(){var e=Object(m.b)(),t=Object(m.c)((function(e){return e.fromStix.fieldSearch}));return i.a.createElement(J.a,{light:!0,labelText:"search",size:"sm",value:t,onChange:function(t){e({type:"UPDATE_SEARCH_FIELD_VALUE",payload:{value:t.target.value}})},placeHolderText:"Search field\u2026"})},z=a(95),G=[{id:d,label:"STIX version 2.0"},{id:u,label:"STIX version 2.1"}],Q=function(){var e=Object(m.b)(),t=Object(m.c)((function(e){return e.stix.stixVersion}));return console.log(G),console.log(t),i.a.createElement("div",null,i.a.createElement(z.a,{ariaLabel:"Dropdown",label:"Select STIX version",selectedItem:G.find((function(e){return e.id===t})),id:"version-of-stix",items:G,onChange:function(t){e(p(t.selectedItem.id))}}))},Y=function(e){var t=e.objectName,a=e.fieldId,n=e.stixFieldId,r=e.type,c=e.objects,l=Object(m.c)((function(e){return e.stix.stixFields}));return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col"},i.a.createElement(Q,null))),i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col ".concat(X.a.full_height__col," ").concat(X.a.add_fields__col)},i.a.createElement(W,null),i.a.createElement(P.a,null,l.map((function(e){return i.a.createElement(H,{key:e.title,title:e.title,type:e.type,items:e.items,objectName:t,fieldId:a,stixFieldId:n,updateType:r,objects:c})}))))))},Z=function(e){var t=e.objects;return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col"},i.a.createElement("h4",{className:"section-title"},"Select Fields")),i.a.createElement("div",null,i.a.createElement(k,null))),i.a.createElement(Y,{objects:t}))},$=a(17),ee=a.n($),te=a(96),ae=a(92),ne=a(97),ie=function(e){var t=e.title,a=Object(m.c)((function(e){return e.fromStix.mapping[t].values})),n=Object(m.b)();return i.a.createElement("li",{className:ee.a.mapping__item},i.a.createElement("div",{className:"bx--row",style:{marginBottom:".5rem"}},i.a.createElement("div",{className:"bx--col-sm-3"},i.a.createElement("h1",{className:ee.a.mapping_item__title},t)),i.a.createElement("div",{className:"bx--col-sm-1 ".concat(ee.a.mapping_item__btn_top)},i.a.createElement(te.a,{className:"".concat(ee.a.mapping_item__btn),style:{border:"1px solid #000000",marginRight:".5rem"},onClick:function(){n({type:"ADD_VALUE",payload:{field:t}})}}),i.a.createElement(ae.a,{className:"".concat(ee.a.mapping_item__btn),style:{border:"1px solid #000000"},onClick:function(){n({type:"DELETE_FIELD",payload:{field:t}})}}))),a.length>0?a.map((function(e){return i.a.createElement("div",{key:"".concat(t,"_").concat(e.id),className:"bx--row",style:{marginBottom:"1rem"}},i.a.createElement("div",{className:"bx--col-sm-3"},i.a.createElement(D.a,{id:"".concat(t,"_").concat(e.id),labelText:"",autoComplete:"off",value:e.value,onChange:function(a){var i,r,c;n((i=t,r=e.id,c=a.target.value,{type:"UPDATE_VALUE",payload:{field:i,id:r,value:c}}))}})),i.a.createElement("div",{className:"bx--col-sm-1",style:{margin:"auto"}},i.a.createElement(ne.a,{className:"".concat(ee.a.mapping_item__btn),onClick:function(){var a,i;n((a=t,i=e.id,{type:"DELETE_VALUE",payload:{field:a,id:i}}))}})))})):i.a.createElement("div",{className:ee.a.mapping__item_empty},"Use the [+] button to add values."))},re=function(){var e=Object(m.b)(),t=Object(m.c)((function(e){return e.fromStix.fieldMappingFilter}));return i.a.createElement(D.a,{light:!0,value:t,onChange:function(t){e({type:"UPDATE_MAPPINGS_FILTER_FIELD_VALUE",payload:{value:t.target.value}})},labelText:"",id:"mappings-filter-input",placeholder:"Filter field\u2026"})},ce=a(44),le=a(108);function oe(e){var t={};return Object.keys(e).forEach((function(a){var n=a.split(":")[0],i=a.split(":")[1];n in t||(t[n]={fields:{}}),t[n].fields[i]=e[a].values.map((function(e){return e.value}))})),t}function me(e){return function(e){var t={};return e?(Object.keys(e).forEach((function(a){if("fields"in e[a]){var n=e[a].fields;Object.keys(n).forEach((function(e){t["".concat(a,":").concat(e)]={values:n[e].map((function(e){return{value:e,id:Object(le.a)()}}))}}))}})),t):t}(e)}var se=function(){var e=Object(m.b)(),t=Object(m.c)((function(e){return e.fromStix.mapping})),a=Object(m.c)((function(e){return e.fromStix.fieldMappingFilter}));return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col"},i.a.createElement("h4",{className:"section-title"},Object.keys(t).length," Total Fields"," ",i.a.createElement("span",{onClick:function(){e({type:"CLEAR_FROM_STIX_MAPPINGS"})},className:ee.a.mappings_clear__btn},"(Clear)")))),i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col"},i.a.createElement(re,null))),i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col ".concat(ee.a.full_height__col," ").concat(ee.a.mapping__col)},i.a.createElement("ul",null,Object.keys(function(e,t){if(!t||""===t)return e;var a=t.toLowerCase();return Object.keys(e).filter((function(e){return e.toLowerCase().includes(a)})).reduce((function(t,a){return t[a]=e[a],t}),{})}(t,a)).map((function(e){return i.a.createElement(ie,{key:e,title:e})}))))))},de=a(98),ue=a(58),pe=a.n(ue),_e=function(e){var t=Object(n.useState)(""),a=Object(S.a)(t,2),r=a[0],c=a[1],l=e.mapping;return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col"},i.a.createElement("h4",{className:"section-title"},"Save Configuration"))),i.a.createElement("div",{className:"bx--row",style:{marginBottom:".75rem"}},i.a.createElement("div",{className:"bx--col ".concat(pe.a.export__col)},i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col"},i.a.createElement(D.a,{autoComplete:"off",id:"export-filename",labelText:"Filename",value:r,onChange:function(e){c(e.target.value)}}))),i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col",style:{textAlign:"right"}},i.a.createElement(M.a,{disabled:0===r.length,renderIcon:de.a,onClick:function(){!function(e,t){var a=new Blob([JSON.stringify(t,null,2)],{type:"application/json"});Object(ce.saveAs)(a,e)}("".concat(r,".json"),e.stateMappingToShifterMapping(l))}},"Save"))))))},be=a(105),fe=a(59),Ee=a.n(fe),ve=function(e){var t=Object(m.b)();return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col"},i.a.createElement("h4",{className:"section-title"},"Load Configuration"))),i.a.createElement("div",{className:"bx--row",style:{marginBottom:".75rem"}},i.a.createElement("div",{className:"bx--col ".concat(Ee.a.import__col)},i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col"},i.a.createElement(be.a,{accept:[".json"],buttonKind:"primary",buttonLabel:"Load file",filenameStatus:"edit",multiple:!1,onDelete:function(){t(e.clearMappings())},onChange:function(a){var n=new FileReader;n.onload=function(a){var n=null;if(a&&"target"in a&&"result"in a.target){n=JSON.parse(a.target.result);var i=e.loadJsonFromDisk(n);t(e.updateMappingsFromFile(i))}},n.readAsText(a.target.files[0])},iconDescription:"Clear file",labelDescription:"Select configuration .json file",labelTitle:""}))))))},je=function(e){var t=e.officialObjectsCount,a=e.requiredObjectsCount,n=e.officialFieldsCount,r=e.requiredFieldsCount,c=t/n*100;return i.a.createElement("div",{className:"bx--col"},i.a.createElement("div",{className:"bx--label-description"},"Official STIX Coverage"),i.a.createElement("div",{className:ee.a.coverage_percent},0===t?0:Math.round(100*c)/100,"%"),i.a.createElement("div",{className:ee.a.coverage_count},t," of ",n," STIX fields"),i.a.createElement("div",{className:ee.a.coverage_count},a," of ",r," required STIX fields"))},Oe=function(e){var t=e.officialObjectsCount,a=e.requiredObjectsCount,r=Object(m.c)((function(e){return e.stix.stixFields})),c=Object(n.useMemo)((function(){return function(e){var t=0,a=0;return Object.keys(e).forEach((function(n){t+=e[n].items.length,Object.keys(e[n].items).forEach((function(t){e[n].items[t].required&&(a+=1)}))})),[t,a]}(r)}),[r]),l=Object(S.a)(c,2),o=l[0],s=l[1];return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col"},i.a.createElement("h4",{className:"section-title"},"Coverage Statistics"))),i.a.createElement("div",{className:"bx--row",style:{marginBottom:".75rem"}},i.a.createElement("div",{className:"bx--col ".concat(ee.a.statistics__col)},i.a.createElement("div",{className:"bx--row"},i.a.createElement(je,{officialObjectsCount:t,requiredObjectsCount:a,officialFieldsCount:o,requiredFieldsCount:s})))))},ye={stix_version_2_0:new Set(["autonomous-system:number","directory:path","domain-name:value","email-addr:value","email-message:is_multipart","ipv4-addr:value","ipv6-addr:value","mac-addr:value","software:name","url:value","user-account:user_id","windows-registry-key:key"]),stix_version_2_1:new Set(["autonomous-system:number","directory:path","domain-name:value","email-addr:value","email-message:is_multipart","ipv4-addr:value","ipv6-addr:value","mac-addr:value","mutex:name","network-traffic:protocols","software:name","url:value","user-account:user_id"])},ge=function(){var e=Object(m.c)((function(e){return e.fromStix.mapping})),t=Object(m.c)((function(e){return e.stix.stixVersion})),a=Object(m.c)((function(e){return e.stix.stixFields})),r=ye[t],c=function(e,t,a){var n=new Set,i=new Set,r=Object.assign.apply(Object,[{}].concat(Object(q.a)(Array.from(Object.keys(t),(function(e){return Object(I.a)({},e,new Set)})))));return Object.keys(e).forEach((function(c){var l=c.split(":"),o=Object(S.a)(l,2),m=o[0],s=o[1];Object.keys(e[c].values).length>0&&Object.keys(e[c].values).forEach((function(l){var o;""!==e[c].values[l].value&&(null===(o=t[m])||void 0===o?void 0:o.includes(s))&&(n.add("".concat(m,":").concat(s)),r[m].add("".concat(s)),a.has("".concat(m,":").concat(s))&&i.add("".concat(m,":").concat(s)))}))})),console.log(r),[r,n.size,i.size]}(e,Object(n.useMemo)((function(){return Object.assign.apply(Object,Object(q.a)(Array.from(a,(function(e){return Object(I.a)({},e.type,e.items.map((function(e){return e.name})))}))))}),[a]),r),l=Object(S.a)(c,3),o=l[0],s=l[1],d=l[2];return i.a.createElement("div",{className:"bx--grid"},i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col"},i.a.createElement("h1",{className:"page-title"},"From STIX"))),i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col-sm-1"},i.a.createElement(Z,{objects:o})),i.a.createElement("div",{className:"bx--col-sm-2"},i.a.createElement(se,null)),i.a.createElement("div",{className:"bx--col-sm-1"},i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col-sm-4"},i.a.createElement(_e,{mapping:e,stateMappingToShifterMapping:oe}))),i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col-sm-4"},i.a.createElement(ve,{loadJsonFromDisk:me,updateMappingsFromFile:F,clearMappings:w}))),i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col-sm-4"},i.a.createElement(Oe,{officialObjectsCount:s,requiredObjectsCount:d}))))))},xe=a(53),he=a(100),Ne=a(10),Se=a.n(Ne),Ie=["None","StringToBool","EpochToTimestamp","FormatMac","FormatTCPProtocol","EpochSecondsToTimestamp","TimestampToMilliseconds","ToInteger","ToString","ToLowercaseArray","ToBase64","ToFilePath","ToDirectoryPath","ToFileName","ToDomainName","ToIPv4","DateTimeToUnixTimestamp","NaiveToUTC","TimestampToUTC","SetToOne","FilterIPv4List","FilterIPv6List","ValueToList","GraphIDToPID"],qe=a(99),Te=a(104),Fe=function(e){var t=e.selectedReferences,a=e.objectKey,r=e.sourceFieldId,c=e.stixFieldId,l=Object(m.b)(),o=Object(m.c)((function(e){return e.toStix.mapping})),s=Object(n.useMemo)((function(){return Object(q.a)(Object.keys(o)).filter((function(e){return e!==a}))}),[a,o]);return i.a.createElement("div",{className:"bx--col-md-2"},i.a.createElement(Te.a,{id:"references",size:"sm",useTitleInItem:!1,label:0!==(null===t||void 0===t?void 0:t.length)?t.map((function(e){return e!==t[t.length-1]?e+", ":e})):"None",invalid:!1,invalidText:"Invalid Selection",onChange:function(e){l(B(a,r,c,e.selectedItems,"references"))},items:s,disabled:0===s.length,initialSelectedItems:t,selectedItem:t,itemToString:function(e){return e||""},inline:!0}))},we=i.a.memo((function(e){var t=e.objectKey,a=e.sourceFieldId,n=e.stixFieldId,r=e.stixFieldKey,c=e.stixFieldTransformer,l=e.stixFieldReferences,o=Object(m.b)();return i.a.createElement("div",{key:n},i.a.createElement("div",{className:"bx--row ".concat(Se.a.object_item__field)},i.a.createElement("div",{className:"bx--col-md-3"},i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col"},i.a.createElement(D.a,{id:n,labelText:"",onChange:function(e){o(B(t,a,n,e.target.value,"key"))},size:"sm",value:r})),i.a.createElement("div",null,i.a.createElement(qe.a,{onClick:function(){o(function(e,t,a){return{type:"OPEN_SELECT_FIELD_MODAL",payload:{objectKey:e,sourceFieldId:t,stixFieldId:a}}}(t,a,n))}})))),i.a.createElement("div",{className:"bx--col-md-2"},i.a.createElement(z.a,{size:"sm",ariaLabel:"Dropdown",id:"transformer",items:Ie,label:"None",selectedItem:c,onChange:function(e){o(B(t,a,n,e.selectedItem,"transformer"))}})),i.a.createElement(Fe,{objectKey:t,sourceFieldId:a,stixFieldId:n,selectedReferences:l}),i.a.createElement("div",null,i.a.createElement(ne.a,{className:"".concat(Se.a.object_item__btn),onClick:function(){o({type:"REMOVE_STIX_FIELD",payload:{objectName:t,fieldId:a,mappingId:n}})}}))))})),Ce=function(e){var t=e.objectKey,a=e.sourceFieldId,n=Object(m.b)();return i.a.createElement("div",{className:"bx--row ".concat(Se.a.object_item_field__header)},i.a.createElement("div",{className:"bx--col-md-3"},"STIX field"),i.a.createElement("div",{className:"bx--col-md-2"},"Transformer"),i.a.createElement("div",{className:"bx--col-md-2"},"References"),i.a.createElement("div",{className:"bx--col-md-1",style:{textAlign:"right"}},i.a.createElement(te.b,{className:"".concat(Se.a.object_item__btn),onClick:function(){n({type:"ADD_STIX_FIELD",payload:{objectName:t,fieldId:a,key:""}})}})))},De=function(e){var t=e.objectKey,a=e.sourceFieldId;return e.stixFieldsData.map((function(e){var n=null===e||void 0===e?void 0:e.transformer,r=e.references&&0!==e.references.length?(e.references,!1===Array?e.references:[e.references]):[];return i.a.createElement(we,{key:e.id,sourceFieldId:a,objectKey:t,stixFieldId:e.id,stixFieldKey:e.key,stixFieldTransformer:n,stixFieldReferences:r})}))},Ae=function(e){var t=e.objectKey,a=e.sourceFieldId,n=e.sourceFieldData;return i.a.createElement("div",{className:"bx--row ".concat(Se.a.object_item__field)},i.a.createElement("div",{className:"bx--col-sm-4"},i.a.createElement(Ce,{objectKey:t,sourceFieldId:a}),i.a.createElement(De,{objectKey:t,sourceFieldId:a,stixFieldsData:n.mapped_to})))},Le=function(e){var t=e.fieldId,a=e.objectKey,n=e.fieldData,r=Object(m.b)();return i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",null,i.a.createElement(he.a,{style:{marginLeft:"1rem",border:0},className:"".concat(Se.a.object_item__btn),onClick:function(){r(function(e,t){return{type:"REMOVE_DATASOURCE_FIELD",payload:{objectName:e,fieldId:t}}}(a,t))}})),i.a.createElement("div",{className:"bx--col"},i.a.createElement(D.a,{labelText:"Source field name",id:t,onChange:function(e){r(function(e,t,a){return{type:"UPDATE_DATASOURCE_FIELD",payload:{objectName:e,fieldId:t,fieldName:a}}}(a,t,e.target.value))},value:n.field,size:"sm"})))},Me=i.a.memo((function(e){var t=e.objectKey,a=e.fieldId,n=e.fieldData;return i.a.createElement("div",{key:a,className:Se.a.object_item__map},i.a.createElement(Le,{objectKey:t,fieldId:a,fieldData:n}),i.a.createElement(Ae,{objectKey:t,sourceFieldId:a,sourceFieldData:n}))})),ke=function(e){var t=e.title,a=e.isOpen,n=e.setIsOpen,r=Object(m.b)();return i.a.createElement("div",{className:"bx--row",style:{cursor:"pointer"},onClick:function(){n(!a)}},i.a.createElement("span",{style:{marginLeft:"1rem"}},a?i.a.createElement(xe.d,null):i.a.createElement(xe.f,null)),i.a.createElement("div",{className:"bx--col ".concat(Se.a.object_item__title)},t),i.a.createElement("div",{className:"bx--col",style:{textAlign:"right"}},i.a.createElement(te.b,{className:"".concat(Se.a.object_item__btn),style:{marginRight:".5rem"},onClick:function(e){e.preventDefault(),e.stopPropagation(),r({type:"ADD_DATASOURCE_FIELD",payload:{objectName:t,fieldName:""}})}}),i.a.createElement(ae.b,{className:"".concat(Se.a.object_item__btn),onClick:function(e){e.preventDefault(),e.stopPropagation(),r({type:"REMOVE_OBJECT",payload:{name:t}})}})))},Pe=function(e){var t=e.sourceFields,a=e.objectKey;return 0===Object.keys(t).length?i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col"},'There are currently no data-source fields mapped. Click the "+" button to add your first data-source field.')):Object.keys(t).map((function(e){return i.a.createElement(Me,{key:e,objectKey:a,fieldId:e,fieldData:t[e]})}))},Re=i.a.memo((function(e){var t=e.objectKey,a=e.objectData,r=Object(n.useState)(!0),c=Object(S.a)(r,2),l=c[0],o=c[1];return i.a.createElement("div",{className:"bx--row ".concat(Se.a.object__item_box)},i.a.createElement("div",{className:"bx--col ".concat(Se.a.object__item_content)},i.a.createElement(ke,{title:t,isOpen:l,setIsOpen:o}),l&&i.a.createElement(Pe,{objectKey:t,sourceFields:a})))})),Xe=function(){var e=Object(m.c)((function(e){return e.toStix.mapping}));return 0===Object.keys(e).length?i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col"},i.a.createElement("p",{style:{paddingTop:"1rem"}},"There are currently no objects to show. Click the \u201cNew object\u201d button to start mapping or load configuration."))):Object.keys(e).map((function(t){return i.a.createElement(Re,{key:t,objectKey:t,objectData:e[t]})}))},Ue=function(){var e=Object(m.b)(),t=Object(m.c)((function(e){return e.toStix.selectFieldModal})),a=!(null===t);return i.a.createElement(C.a,{shouldSubmitOnEnter:!0,open:a,onRequestClose:function(){e({type:"CLOSE_SELECT_FIELD_MODAL"})},modalHeading:"Select field",hasForm:!1,passiveModal:!0},a&&i.a.createElement(Y,{objectName:t.objectKey,fieldId:t.sourceFieldId,stixFieldId:t.stixFieldId,type:"key"}))},Be=function(){var e=Object(m.b)();return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ue,null),i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col",style:{textAlign:"right"}},i.a.createElement(M.a,{renderIcon:te.c,onClick:function(){e({type:"OPEN_NEW_OBJECT_MODAL"})}},"New Object"))),i.a.createElement(Xe,null))},Ve=function(){var e=Object(m.b)(),t=Object(m.c)((function(e){return e.toStix.isNewObjectModalOpen})),a=Object(n.useState)(""),r=Object(S.a)(a,2),c=r[0],l=r[1];return i.a.createElement(C.a,{shouldSubmitOnEnter:!0,open:t,onRequestClose:function(){l(""),e({type:"CLOSE_NEW_OBJECT_MODAL"})},onRequestSubmit:function(){""!==c&&(e({type:"ADD_NEW_OBJECT",payload:{name:c}}),l("")),e({type:"CLOSE_NEW_OBJECT_MODAL"})},primaryButtonText:"Create",secondaryButtonText:"Cancel",modalHeading:"Create new object",hasForm:!0,primaryButtonDisabled:""===c},i.a.createElement(D.a,{id:"new-object-name",labelText:"Object name",onChange:function(e){l(e.target.value)},value:c,helperText:"Should be lowercase, use dash for spacing, e.g. `foo_bar` "}))},Ke=a(3);function He(e){return function e(t,a,n){return t?(Object.keys(t).forEach((function(i){if(typeof Object.keys(t[i])===Array)console.log(i),e(t[i],a,i);else if(new Set(Object.keys(t[i])).has("key"))if(new Set(Object.keys(t[i])).has("object")){var r,c,l=t[i].object,o=Object(le.a)(),m=Object(le.a)(),s=function(e,t,a,n){var i=[];t in e&&(i=Object.keys(e[t]).filter((function(n){return a===e[t][n].field})));return 0!==i.length?i[0]:n}(a,l,i,o),d=null===(r=t[i])||void 0===r?void 0:r.references,u=null===(c=t[i])||void 0===c?void 0:c.transformer,p=Object(Ke.a)(Object(Ke.a)({id:m,key:t[i].key.replace(".",":")},u?{transformer:u}:{}),d?{references:d}:{});a[l]=Object(Ke.a)({},a[l]),a[l][s]=Object(Ke.a)(Object(Ke.a)(Object(Ke.a)({},a[l][s]),s===o?{field:n||i}:{}),{},{mapped_to:[s!==o?Object(Ke.a)(Object(Ke.a)({},a[l][s].mapped_to),p):p]})}else console.log("TODO - metadata");else{var _=n?"".concat(n,".").concat(i):i;console.log(_),e(t[i],a,_)}})),a):a}(e,{},"")}function Je(e){var t={};return Object.keys(e).forEach((function(a){Object.keys(e[a]).forEach((function(n){var i=e[a][n].field,r=e[a][n].mapped_to;Object.keys(r).forEach((function(e){var n=r[e].key.replace(":","."),c=r[e].transformer&&"None"!==r[e].transformer?r[e].transformer:null,l=r[e].references?r[e].references:null;i in t||(t[i]=[]),n in t[i]||(t=Object(Ke.a)(Object(Ke.a)({},t),{},Object(I.a)({},i,[].concat(Object(q.a)(t[i]),[Object(Ke.a)(Object(Ke.a)({key:n,object:a},c?{transformer:c}:{}),l?{references:l}:{})]))))}))}))})),t}var We=function(e){var t=e.fieldsCount,a=e.objectsCount,n=e.sum,r=e.type,c=t/n*100;return i.a.createElement("div",{className:"bx--col"},i.a.createElement("div",{className:"bx--label-description"},r," STIX fields"),i.a.createElement("div",{className:Se.a.coverage_percent},0===n?0:Math.round(100*c)/100,"%"),i.a.createElement("div",{className:Se.a.coverage_count},t," STIX fields"),i.a.createElement("div",{className:Se.a.coverage_count},a," STIX objects"))},ze=function(e){var t=e.mapping,a=Object(m.c)((function(e){return e.stix.stixFields})),r=function(e,t){var a=new Set,n=new Set,i=new Set,r=new Set;return Object.keys(e).forEach((function(c){Object.keys(e[c]).forEach((function(l){Object.keys(e[c][l].mapped_to).forEach((function(o){var m=e[c][l].mapped_to[o].key.split(":"),s=Object(S.a)(m,2),d=s[0],u=s[1];t.has(d)?(a.add("".concat(d,":").concat(u)),i.add(c)):d.startsWith("x-")&&(n.add("".concat(d,":").concat(u)),r.add(c))}))}))})),[a.size,n.size,i.size,r.size]}(t,Object(n.useMemo)((function(){return new Set(Object.values(a).map((function(e){return e.type})))}),[a])),c=Object(S.a)(r,4),l=c[0],o=c[1],s=c[2],d=c[3],u=l+o;return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col"},i.a.createElement("h4",{className:"section-title"},"Official VS Custom STIX fields"))),i.a.createElement("div",{className:"bx--row",style:{marginBottom:".75rem"}},i.a.createElement("div",{className:"bx--col ".concat(Se.a.statistics__col)},i.a.createElement("div",{className:"bx--row"},i.a.createElement(We,{fieldsCount:l,objectsCount:s,sum:u,type:"Official"}))),i.a.createElement("div",{className:"bx--col ".concat(Se.a.statistics__col)},i.a.createElement("div",{className:"bx--row"},i.a.createElement(We,{fieldsCount:o,objectsCount:d,sum:u,type:"Custom"})))))},Ge=function(){var e=Object(m.c)((function(e){return e.toStix.mapping}));return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ve,null),i.a.createElement("div",{className:"bx--grid"},i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col"},i.a.createElement("h1",{className:"page-title"},"To STIX"))),i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col-sm-3"},i.a.createElement(Be,null)),i.a.createElement("div",{className:"bx--col-sm-1"},i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col-sm-4"},i.a.createElement(_e,{mapping:e,stateMappingToShifterMapping:Je}))),i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col-sm-4"},i.a.createElement(ve,{loadJsonFromDisk:He,updateMappingsFromFile:K,clearMappings:V}))),i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col-sm-4"},i.a.createElement(ze,{mapping:e})))))))},Qe=a(101),Ye=a(102),Ze=(a(78),function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col"},i.a.createElement("img",{src:"https://user-images.githubusercontent.com/16198896/129204519-78bb6448-246e-4e6d-a456-182792c7b894.png",alt:"logo"}),i.a.createElement("h4",null,"STIX-Shifter Connector's Mapping Builder"))),i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col"},i.a.createElement(P.a,{align:"start"},i.a.createElement(U.a,{title:"Introduction",open:!0},i.a.createElement("p",null,"The map-my-shifter (MMS) project provides a visual way for building mapping files for"," ",i.a.createElement("a",{href:"https://github.com/opencybersecurityalliance/stix-shifter"},"STIX-Shifter")," ","project."),i.a.createElement(Qe.a,null,i.a.createElement(Ye.a,null,"From STIX pattern mapping - When building the data source query from STIX query, the STIX fields, for examples `file:name`, is mapped to the target data source's field.",i.a.createElement("a",{href:"https://github.com/opencybersecurityalliance/stix-shifter/blob/master/adapter-guide/develop-translation-module.md#step-2-edit-the-from_stix_map-json-files"},"Read more...")),i.a.createElement(Ye.a,null,"To STIX object mapping - When results object is back from the data source, this object should be displayed in the final results as STIX object. For examples ","{",'"filename": "xxxxx"} should be translated to STIX object of type `file`.',i.a.createElement("a",{href:"https://github.com/opencybersecurityalliance/stix-shifter/blob/master/adapter-guide/develop-translation-module.md#step-4-edit-the-to_stix_map-json-file"},"Read more...")))),i.a.createElement(U.a,{title:"Use-cases",open:!0},i.a.createElement(Qe.a,null,i.a.createElement(Ye.a,null,"Create mapping file from scratch."),i.a.createElement(Ye.a,null,"Load existing mapping file, edit the file and save it to a new file"))),i.a.createElement(U.a,{title:"Authors",open:!0},i.a.createElement(Qe.a,null,i.a.createElement(Ye.a,null,i.a.createElement("a",{href:"https://github.com/barvhaim"},"Bar Haim")),i.a.createElement(Ye.a,null,i.a.createElement("a",{href:"https://github.com/idohersko"},"Ido Hersko")),i.a.createElement(Ye.a,null,i.a.createElement("a",{href:"https://github.com/noaakl"},"Noaa Kless")))),i.a.createElement(U.a,{title:"Licensing",open:!0},i.a.createElement("p",null,"map-my-shifter is licensed under the Apache License, Version 2.0. See"," ",i.a.createElement("a",{href:"https://github.com/barvhaim/map-my-shifter/blob/master/LICENSE"},"LICENSE")," ","for the full license text."))))),i.a.createElement("div",{className:"bx--row"},i.a.createElement("div",{className:"bx--col footer"},i.a.createElement("p",null,"Built with ",i.a.createElement("span",{className:"heart"},"\u2764")," from"," ",i.a.createElement("a",{href:"https://www.research.ibm.com/haifa/ccoe/"},"IBM Cyber Security Center of Excellence (CCoE)")))))}),$e=a(45),et=[{title:"Artifact",type:"artifact",items:[{name:"mime_type",required:!1},{name:"payload_bin",required:!1},{name:"url",required:!1},{name:"hashes.SHA-256",required:!1},{name:"hashes.MD5",required:!1},{name:"hashes.SHA-1",required:!1}]},{title:"AS",type:"autonomous-system",items:[{name:"number",required:!0},{name:"name",required:!1},{name:"rir",required:!1}]},{title:"Directory",type:"directory",items:[{name:"path",required:!0},{name:"path_enc",required:!1},{name:"created",required:!1},{name:"modified",required:!1},{name:"accessed",required:!1}]},{title:"Domain Name",type:"domain-name",items:[{name:"value",required:!0}]},{title:"Email Address",type:"email-addr",items:[{name:"value",required:!0},{name:"display_name",required:!1}]},{title:"Email Message",type:"email-message",items:[{name:"is_multipart",required:!0},{name:"date",required:!1},{name:"content_type",required:!1},{name:"subject",required:!1},{name:"body",required:!1}]},{title:"File",type:"file",items:[{name:"hashes.SHA-256",required:!1},{name:"hashes.MD5",required:!1},{name:"hashes.SHA-1",required:!1},{name:"size",required:!1},{name:"name",required:!1},{name:"name_enc",required:!1},{name:"magic_number_hex",required:!1},{name:"mime_type",required:!1},{name:"created",required:!1},{name:"modified",required:!1},{name:"accessed",required:!1},{name:"is_encrypted",required:!1}]},{title:"IPv4 Address",type:"ipv4-addr",items:[{name:"value",required:!0}]},{title:"IPv6 Address",type:"ipv6-addr",items:[{name:"value",required:!0}]},{title:"MAC Address",type:"mac-addr",items:[{name:"value",required:!0}]},{title:"Network Traffic",type:"network-traffic",items:[{name:"src_port",required:!1},{name:"dst_port",required:!1},{name:"protocols",required:!1}]},{title:"Process",type:"process",items:[{name:"pid",required:!1},{name:"name",required:!1},{name:"created",required:!1},{name:"command_line",required:!1}]},{title:"Software",type:"software",items:[{name:"name",required:!0},{name:"cpe",required:!1},{name:"vendor",required:!1},{name:"version",required:!1}]},{title:"URL",type:"url",items:[{name:"value",required:!0}]},{title:"User Account",type:"user-account",items:[{name:"user_id",required:!0},{name:"account_login",required:!1},{name:"account_type",required:!1},{name:"display_name",required:!1},{name:"is_service_account",required:!1},{name:"is_privileged",required:!1},{name:"is_disabled",required:!1}]},{title:"Windows\u2122 Registry Key",type:"windows-registry-key",items:[{name:"key",required:!0},{name:"values",required:!1},{name:"modified",required:!1},{name:"number_of_subkeys",required:!1}]}],tt=[{title:"Artifact",type:"artifact",items:[{name:"mime_type",required:!1},{name:"payload_bin",required:!1},{name:"url",required:!1},{name:"hashes.SHA-256",required:!1},{name:"hashes.MD5",required:!1},{name:"hashes.SHA-1",required:!1},{name:"encryption_algorithm",required:!1},{name:"decryption_key",required:!1}]},{title:"AS",type:"autonomous-system",items:[{name:"number",required:!0},{name:"name",required:!1},{name:"rir",required:!1}]},{title:"Directory",type:"directory",items:[{name:"path",required:!0},{name:"path_enc",required:!1},{name:"ctime",required:!1},{name:"mtime",required:!1},{name:"atime",required:!1}]},{title:"Domain Name",type:"domain-name",items:[{name:"value",required:!0}]},{title:"Email Address",type:"email-addr",items:[{name:"value",required:!0},{name:"display_name",required:!1}]},{title:"Email Message",type:"email-message",items:[{name:"is_multipart",required:!0},{name:"date",required:!1},{name:"content_type",required:!1},{name:"message_id",required:!1},{name:"subject",required:!1},{name:"received_lines",required:!1},{name:"additional_header_fields",required:!1},{name:"body",required:!1},{name:"body_multipart",required:!1}]},{title:"File",type:"file",items:[{name:"extensions",required:!1},{name:"hashes.SHA-256",required:!1},{name:"hashes.MD5",required:!1},{name:"hashes.SHA-1",required:!1},{name:"size",required:!1},{name:"name",required:!1},{name:"name_enc",required:!1},{name:"magic_number_hex",required:!1},{name:"mime_type",required:!1},{name:"ctime",required:!1},{name:"mtime",required:!1},{name:"atime",required:!1}]},{title:"IPv4 Address",type:"ipv4-addr",items:[{name:"value",required:!0}]},{title:"IPv6 Address",type:"ipv6-addr",items:[{name:"value",required:!0}]},{title:"MAC Address",type:"mac-addr",items:[{name:"value",required:!0}]},{title:"Mutex",type:"mutex",items:[{name:"name",required:!0}]},{title:"Network Traffic",type:"network-traffic",items:[{name:"extensions",required:!1},{name:"start",required:!1},{name:"end",required:!1},{name:"is_active",required:!1},{name:"src_port",required:!1},{name:"dst_port",required:!1},{name:"protocols",required:!0},{name:"src_byte_count",required:!1},{name:"dst_byte_count",required:!1},{name:"src_packets",required:!1},{name:"dst_packets",required:!1},{name:"ipfix",required:!1}]},{title:"Process",type:"process",items:[{name:"extensions",required:!1},{name:"is_hidden",required:!1},{name:"pid",required:!1},{name:"created_time",required:!1},{name:"cwd",required:!1},{name:"command_line",required:!1},{name:"environment_variables",required:!1}]},{title:"Software",type:"software",items:[{name:"name",required:!0},{name:"cpe",required:!1},{name:"swid",required:!1},{name:"languages",required:!1},{name:"vendor",required:!1},{name:"version",required:!1}]},{title:"URL",type:"url",items:[{name:"value",required:!0}]},{title:"User Account",type:"user-account",items:[{name:"extensions",required:!1},{name:"user_id",required:!0},{name:"credential",required:!1},{name:"account_login",required:!1},{name:"account_type",required:!1},{name:"display_name",required:!1},{name:"is_service_account",required:!1},{name:"is_privileged",required:!1},{name:"can_escalate_privs",required:!1},{name:"is_disabled",required:!1},{name:"account_created",required:!1},{name:"account_expires",required:!1},{name:"credential_last_changed",required:!1},{name:"account_first_login",required:!1},{name:"account_last_login",required:!1}]},{title:"Windows\u2122 Registry Key",type:"windows-registry-key",items:[{name:"key",required:!1},{name:"values",required:!1},{name:"modified_time",required:!1},{name:"number_of_subkeys",required:!1}]}];function at(e,t){if(!t||""===t)return e;var a=t.toLowerCase(),n=e.filter((function(e){return e.title.toLowerCase().includes(a)||e.type.includes(a)}));return n=n.filter((function(e){return e.items.length>0}))}var nt={stixFields:et,fieldSearch:"",stixVersion:d},it=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_SEARCH_FIELD_VALUE":switch(e.stixVersion){case d:return Object(Ke.a)(Object(Ke.a)({},e),{},{fieldSearch:t.payload.value,stixFields:at(et,t.payload.value)});case u:return Object(Ke.a)(Object(Ke.a)({},e),{},{fieldSearch:t.payload.value,stixFields:at(tt,t.payload.value)});default:return Object(Ke.a)(Object(Ke.a)({},e),{},{fieldSearch:t.payload.value,stixFields:at(et,t.payload.value)})}case"CHANGE_STIX_VERSION":switch(t.payload.version){case d:return Object(Ke.a)(Object(Ke.a)({},e),{},{fieldSearch:"",stixVersion:t.payload.version,stixFields:et});case u:return Object(Ke.a)(Object(Ke.a)({},e),{},{fieldSearch:"",stixVersion:t.payload.version,stixFields:tt});default:return e}default:return e}},rt=a(40),ct=a(39),lt={mapping:{},fieldMappingFilter:"",customFieldModalShow:!1},ot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_FIELD":var a=t.payload.field;return Object(Ke.a)(Object(Ke.a)({},e),{},{mapping:Object(Ke.a)(Object(Ke.a)({},e.mapping),{},Object(I.a)({},a,{required:t.payload.required,values:[]}))});case"DELETE_FIELD":if(t.payload.field in e.mapping){var n=e.mapping,i=t.payload.field,r=(n[i],Object(rt.a)(n,[i].map(ct.a)));return Object(Ke.a)(Object(Ke.a)({},e),{},{mapping:r})}return e;case"ADD_VALUE":return t.payload.field in e.mapping?Object(Ke.a)(Object(Ke.a)({},e),{},{mapping:Object(Ke.a)(Object(Ke.a)({},e.mapping),{},Object(I.a)({},t.payload.field,Object(Ke.a)(Object(Ke.a)({},e.mapping[t.payload.field]),{},{values:[].concat(Object(q.a)(e.mapping[t.payload.field].values),[{value:"",id:Object(le.a)()}])})))}):e;case"DELETE_VALUE":return t.payload.field in e.mapping?Object(Ke.a)(Object(Ke.a)({},e),{},{mapping:Object(Ke.a)(Object(Ke.a)({},e.mapping),{},Object(I.a)({},t.payload.field,Object(Ke.a)(Object(Ke.a)({},e.mapping[t.payload.field]),{},{values:e.mapping[t.payload.field].values.filter((function(e){return e.id!==t.payload.id}))})))}):e;case"UPDATE_VALUE":return t.payload.field in e.mapping?Object(Ke.a)(Object(Ke.a)({},e),{},{mapping:Object(Ke.a)(Object(Ke.a)({},e.mapping),{},Object(I.a)({},t.payload.field,Object(Ke.a)(Object(Ke.a)({},e.mapping[t.payload.field]),{},{values:e.mapping[t.payload.field].values.map((function(e){return e.id===t.payload.id?Object(Ke.a)(Object(Ke.a)({},e),{},{value:t.payload.value}):e}))})))}):e;case"UPDATE_MAPPINGS_FILTER_FIELD_VALUE":return Object(Ke.a)(Object(Ke.a)({},e),{},{fieldMappingFilter:t.payload.value});case"UPDATE_FROM_STIX_MAPPINGS_FROM_FILE":return Object(Ke.a)(Object(Ke.a)({},e),{},{mapping:t.payload.mappings});case"CLEAR_FROM_STIX_MAPPINGS":return Object(Ke.a)(Object(Ke.a)({},e),{},{mapping:{}});case"SHOW_CUSTOM_FIELD_MODAL":return Object(Ke.a)(Object(Ke.a)({},e),{},{customFieldModalShow:!0});case"CLOSE_CUSTOM_FIELD_MODAL":return Object(Ke.a)(Object(Ke.a)({},e),{},{customFieldModalShow:!1});default:return e}},mt={isNewObjectModalOpen:!1,selectFieldModal:null,mapping:{}},st=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"OPEN_NEW_OBJECT_MODAL":return Object(Ke.a)(Object(Ke.a)({},e),{},{isNewObjectModalOpen:!0});case"CLOSE_NEW_OBJECT_MODAL":return Object(Ke.a)(Object(Ke.a)({},e),{},{isNewObjectModalOpen:!1});case"OPEN_SELECT_FIELD_MODAL":return Object(Ke.a)(Object(Ke.a)({},e),{},{selectFieldModal:{objectKey:t.payload.objectKey,sourceFieldId:t.payload.sourceFieldId,stixFieldId:t.payload.stixFieldId}});case"CLOSE_SELECT_FIELD_MODAL":return Object(Ke.a)(Object(Ke.a)({},e),{},{selectFieldModal:null});case"ADD_NEW_OBJECT":var a;return(null===(a=t.payload)||void 0===a?void 0:a.name)in e.mapping?e:Object(Ke.a)(Object(Ke.a)({},e),{},{mapping:Object(Ke.a)(Object(Ke.a)({},e.mapping),{},Object(I.a)({},t.payload.name,{}))});case"REMOVE_OBJECT":var n;if((null===(n=t.payload)||void 0===n?void 0:n.name)in e.mapping){var i,r=e.mapping,c=null===(i=t.payload)||void 0===i?void 0:i.name,l=(r[c],Object(rt.a)(r,[c].map(ct.a)));return Object(Ke.a)(Object(Ke.a)({},e),{},{mapping:l})}return e;case"ADD_DATASOURCE_FIELD":var o,m,s=null===(o=t.payload)||void 0===o?void 0:o.objectName,d=null===(m=t.payload)||void 0===m?void 0:m.fieldName;return s in e.mapping?Object(Ke.a)(Object(Ke.a)({},e),{},{mapping:Object(Ke.a)(Object(Ke.a)({},e.mapping),{},Object(I.a)({},s,Object(Ke.a)(Object(Ke.a)({},e.mapping[s]),{},Object(I.a)({},Object(le.a)(),{field:d,mapped_to:[]}))))}):e;case"UPDATE_DATASOURCE_FIELD":var u,p,_,b=null===(u=t.payload)||void 0===u?void 0:u.objectName,f=null===(p=t.payload)||void 0===p?void 0:p.fieldName,E=null===(_=t.payload)||void 0===_?void 0:_.fieldId;return b in e.mapping&&E in e.mapping[b]?Object(Ke.a)(Object(Ke.a)({},e),{},{mapping:Object(Ke.a)(Object(Ke.a)({},e.mapping),{},Object(I.a)({},b,Object(Ke.a)(Object(Ke.a)({},e.mapping[b]),{},Object(I.a)({},E,Object(Ke.a)(Object(Ke.a)({},e.mapping[b][E]),{},{field:f})))))}):e;case"REMOVE_DATASOURCE_FIELD":var v,j,O=null===(v=t.payload)||void 0===v?void 0:v.objectName,y=null===(j=t.payload)||void 0===j?void 0:j.fieldId;if(O in e.mapping&&y in e.mapping[O]){var g=e.mapping[O],x=(g[y],Object(rt.a)(g,[y].map(ct.a)));return Object(Ke.a)(Object(Ke.a)({},e),{},{mapping:Object(Ke.a)(Object(Ke.a)({},e.mapping),{},Object(I.a)({},O,x))})}return e;case"ADD_STIX_FIELD":var h,N,S,T=null===(h=t.payload)||void 0===h?void 0:h.objectName,F=null===(N=t.payload)||void 0===N?void 0:N.fieldId,w=null===(S=t.payload)||void 0===S?void 0:S.key;return T in e.mapping?Object(Ke.a)(Object(Ke.a)({},e),{},{mapping:Object(Ke.a)(Object(Ke.a)({},e.mapping),{},Object(I.a)({},T,Object(Ke.a)(Object(Ke.a)({},e.mapping[T]),{},Object(I.a)({},F,Object(Ke.a)(Object(Ke.a)({},e.mapping[T][F]),{},{mapped_to:[].concat(Object(q.a)(e.mapping[T][F].mapped_to),[{id:Object(le.a)(),key:w}])})))))}):e;case"REMOVE_STIX_FIELD":var C,D,A,L=null===(C=t.payload)||void 0===C?void 0:C.objectName,M=null===(D=t.payload)||void 0===D?void 0:D.fieldId,k=null===(A=t.payload)||void 0===A?void 0:A.mappingId;return L in e.mapping&&M in e.mapping[L]?Object(Ke.a)(Object(Ke.a)({},e),{},{mapping:Object(Ke.a)(Object(Ke.a)({},e.mapping),{},Object(I.a)({},L,Object(Ke.a)(Object(Ke.a)({},e.mapping[L]),{},Object(I.a)({},M,Object(Ke.a)(Object(Ke.a)({},e.mapping[L][M]),{},{mapped_to:e.mapping[L][M].mapped_to.filter((function(e){return e.id!==k}))})))))}):e;case"UPDATE_STIX_FIELD":var P,R,X,U,B,V=null===(P=t.payload)||void 0===P?void 0:P.objectName,K=null===(R=t.payload)||void 0===R?void 0:R.fieldId,H=null===(X=t.payload)||void 0===X?void 0:X.mappingId,J=null===(U=t.payload)||void 0===U?void 0:U.value,W=null===(B=t.payload)||void 0===B?void 0:B.type;return V in e.mapping&&K in e.mapping[V]?Object(Ke.a)(Object(Ke.a)({},e),{},{mapping:Object(Ke.a)(Object(Ke.a)({},e.mapping),{},Object(I.a)({},V,Object(Ke.a)(Object(Ke.a)({},e.mapping[V]),{},Object(I.a)({},K,Object(Ke.a)(Object(Ke.a)({},e.mapping[V][K]),{},{mapped_to:e.mapping[V][K].mapped_to.map((function(e){return e.id===H?Object(Ke.a)(Object(Ke.a)({},e),{},Object(I.a)({},W,J)):e}))})))))}):e;case"CLEAR_TO_STIX_MAPPINGS":return Object(Ke.a)(Object(Ke.a)({},e),{},{mapping:{}});case"UPDATE_TO_STIX_MAPPINGS_FROM_FILE":return Object(Ke.a)(Object(Ke.a)({},e),{},{mapping:t.payload.mappings});default:return e}},dt=Object($e.a)({stix:it,fromStix:ot,toStix:st}),ut=Object($e.b)(dt,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());var pt=function(){return i.a.createElement(m.a,{store:ut},i.a.createElement(l.a,null,i.a.createElement(j,null),i.a.createElement(s.a,null,i.a.createElement(o.c,null,i.a.createElement(o.a,{path:"/from_stix"},i.a.createElement(ge,null)),i.a.createElement(o.a,{path:"/to_stix"},i.a.createElement(Ge,null)),i.a.createElement(o.a,{path:"/about"},i.a.createElement(Ze,null)),i.a.createElement(o.a,{path:"/"},i.a.createElement(N,null))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement(pt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[66,1,2]]]);
//# sourceMappingURL=main.49477246.chunk.js.map